<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stochastic Generation of Daily Precipitation Time Series • RGENERATEPREC</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Stochastic Generation of Daily Precipitation Time Series">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RGENERATEPREC</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/precipitation_stochastic_generation_v8.html">Stochastic Generation of Daily Precipitation Time Series</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ecor/RGENERATEPREC/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><link href="precipitation_stochastic_generation_v8_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="precipitation_stochastic_generation_v8_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><link href="precipitation_stochastic_generation_v8_files/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="precipitation_stochastic_generation_v8_files/leaflet-1.3.1/leaflet.js"></script><link href="precipitation_stochastic_generation_v8_files/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="precipitation_stochastic_generation_v8_files/proj4-2.6.2/proj4.min.js"></script><script src="precipitation_stochastic_generation_v8_files/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="precipitation_stochastic_generation_v8_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="precipitation_stochastic_generation_v8_files/leaflet-binding-2.2.2/leaflet.js"></script><script src="precipitation_stochastic_generation_v8_files/leaflet-providers-2.0.0/leaflet-providers_2.0.0.js"></script><script src="precipitation_stochastic_generation_v8_files/leaflet-providers-plugin-2.2.2/leaflet-providers-plugin.js"></script><link href="precipitation_stochastic_generation_v8_files/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="precipitation_stochastic_generation_v8_files/HomeButton-0.0.1/home-button.js"></script><script src="precipitation_stochastic_generation_v8_files/HomeButton-0.0.1/easy-button-src.min.js"></script><script src="precipitation_stochastic_generation_v8_files/clipboard-0.0.1/setClipboardText.js"></script><link href="precipitation_stochastic_generation_v8_files/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="precipitation_stochastic_generation_v8_files/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Stochastic Generation of Daily Precipitation
Time Series</h1>
                        <h4 data-toc-skip class="author">Emanuele
Cordano</h4>
            
            <h4 data-toc-skip class="date">2024-08-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ecor/RGENERATEPREC/blob/HEAD/vignettes/precipitation_stochastic_generation_v8.Rmd" class="external-link"><code>vignettes/precipitation_stochastic_generation_v8.Rmd</code></a></small>
      <div class="hidden name"><code>precipitation_stochastic_generation_v8.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Stochastic generators of weather variables, called “Weather
Generators” (WGs) have been widely developed in the recent decades for
hydrological and agricultural applications (e.g. <span class="citation">Richardson (1981)</span> <span class="citation">Racsko,
Szeidl, and Semenov (1991)</span>, <span class="citation">Mikhail A.
Semenov and Barrow (1997)</span>, <span class="citation">Parlange and
Katz (01 May. 2000)</span>,<span class="citation">Liu et al.
(2009)</span>,<span class="citation">J. Chen, Brissette, and Leconte
(2012)</span>,<span class="citation">Jie Chen and Brissette
(2014)</span>,<span class="citation">Cordano and Eccel (2016)</span>,
<span class="citation">Verdin et al. (2018)</span> ). These instruments
have been used in several applications related to plant phenology and
agriculture (e.g. <span class="citation">Delerce et al. (2016)</span>,
<span class="citation">Benmoussa et al. (2018)</span>, <span class="citation">Alikadic et al. (2019)</span>) and hydroclimatic case
studies (e.g. <span class="citation">Fu, Chiew, and Shi (2018)</span>,
<span class="citation">Ahn and Steinschneider (2018)</span>). Former
applications of WGs are the reproductions of daily weather time series
from downscaled monthly climate predictions (<span class="citation">Mearns et al. (2001)</span>,<span class="citation">Wilks and Wilby (1999)</span>,<span class="citation">Qian, Corte-Real, and Xu (2002)</span>,<span class="citation">M. A. Semenov and Stratonovitch (2010)</span>). If
high-resolution application models are to be used with downscaled
series, a meteorological consistence of generated series is required,
suggesting the use of a multi-site weather generator. Algorithms to
represent historical spatial dependences of weather variables have been
developed by <span class="citation">Wilks (1998)</span>,<span class="citation">Khalili, Brissette, and Leconte (2009)</span>,<span class="citation">Serinaldi (2009)</span> and <span class="citation">Bárdossy and Pegram (2009)</span>. <span class="citation">Wilks (1998)</span> simulated rainfall occurrences
through a generation of combinations of Gaussian random variables and
established a relationship for each pair of rain gauges between Gaussian
variables correlation and binary precipitation occurrence values. In
this way, weather generators can reproduce at least partially spatial
correlations. This approach is widely cited in literature (e.g. <span class="citation">Mehrotra, Srikanthan, and Sharma (2006)</span>,<span class="citation">Brissette, Khalili, and Leconte (2007)</span>,<span class="citation">Serinaldi (2009)</span>,<span class="citation">Thompson, Thomson, and Zheng (2007)</span>,<span class="citation">Mhanna and Bauwens (2011)</span>).<br>
In principle, <strong>RMAWGEN</strong> (RMultisite Auto-regressive
Weather Generator) was developed to cope with the demand for
high-resolution climatic scenarios but also to create a flexible tool
for engineers, climatologists, and environmental sciences modellers.
Recently, statistical methods useful for weather generation, originally
developed in environmetrics and econometrics, were made available in the
R platform. <strong>RMAWGEN</strong> uses R’s existing tools for vector
auto-regressive models (<span class="citation">Pfaff (2008)</span>),
employed for generation of weather variables (<span class="citation">Adenomon and Oyejola (2013)</span>,<span class="citation">Luguterah, Nasiru, and Anzagra (2013)</span>,<span class="citation">Shahin, Ali, and Ali (2014)</span>), and to let the end
users work with other R spatio-temporal tools for data analysis and
visualization (<span class="citation">Bivand, Pebesma, and Gomez-Rubio
(2008)</span>,<span class="citation">Loecher and Berlin School of
Economics and Law (2012)</span>,<span class="citation">Kahle and Wickham
(2013)</span>,<span class="citation">Cheng, Karambelkar, and Xie
(2018)</span>). <strong>RMAWGEN</strong> (<span class="citation">Cordano
and Eccel (2019)</span>) carries out generations of weather series
through Vector Auto-regressive Models; the latter work generally well
for time-continuous variables, but present some critical issues for
intermittent weather variables like precipitation. Meanwhile,
<strong>RGENERATE</strong> (<span class="citation">Cordano
(2015)</span>) has been created to create several the stochasic
generation algorithms by using a unique S3/S4 method called starting
from the ones in <strong>RMAWGEN</strong> to other models, where
stochastic weather generations follow different algorithms.
<strong>RGENERATEPREC</strong> contains an extension the
<em>generate</em> methods in order to make a stochstic generation of
precipitations, using logistic regression instead of linear regression
used for the Gaussianized variables in <strong>RMAWGEN</strong>.</p>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The scope of this vignette is a generation of stochastic times series
of daily precipitatoion with the same stastistical properties
(e.g. probability distrubtions of precipitation occurrence,
precipitation account, dry spell, wet spell per each month of the year)
of the observed one(s). The weather generator can work with one or more
time series generating scenarios for several sites and mantainig their
spatial cross-correlation. This vignette shows an example of a
stochastic generation based on a single observed time series in a
rainfall gauging station and a generation of several time series based
on a network of rainfall gauging stations. Therefore, an examples of
stochastic generator of daily time series based on climate possible
projections when precipitation amount probability distribution is
assigned. The examples make used of the example dataset already
presented in <strong>RMAWGEN</strong> package, dataset already imported
by <strong>RGENERATEPREC</strong>. Therefore, package
<em>RGENARATEPREC</em> and other necessary packages are loaded as
follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ecor/RGENERATEPREC" class="external-link">RGENERATEPREC</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="trentino-example-dataset">Trentino Example Dataset<a class="anchor" aria-label="anchor" href="#trentino-example-dataset"></a>
</h2>
<p>The <em>trentino</em> dataset, provided by <strong>RMAWGEN</strong>
package, is a collection of daily values of precipitation, minimum
temperature, maximum temperature in a 50-year long temporal window from
1958-01-01 to 2007-12-31 .</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trentino</span><span class="op">)</span></span></code></pre></div>
<p>The stations are spread in a territory covering Trentino and its
neighbourhood (<span class="citation">Cheng, Karambelkar, and Xie
(2018)</span>).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/mapview" class="external-link">mapview</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">trentino_stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">STATION_LATLON</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,y<span class="op">=</span><span class="va">STATION_LATLON</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,name<span class="op">=</span><span class="va">STATION_NAMES</span><span class="op">)</span></span>
<span><span class="co">######</span></span>
<span><span class="va">trentino_stations</span><span class="op">$</span><span class="va">geometry</span> <span class="op">&lt;-</span> <span class="va">trentino_stations</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>,<span class="st">"y"</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">st_point</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">trentino_stations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/sf.html" class="external-link">st_sf</a></span><span class="op">(</span><span class="va">trentino_stations</span>,geometry<span class="op">=</span><span class="va">trentino_stations</span><span class="op">$</span><span class="va">geometry</span>,crs<span class="op">=</span><span class="fl">4326</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapView.html" class="external-link">mapview</a></span><span class="op">(</span><span class="va">trentino_stations</span>,col.regions<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<div class="leaflet html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:672px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[46.05256203420795,46.01056590838731,46.11555867238381,46.0702519042617,46.26141512982218,46.19562421789631,45.94027785283678,46.36398999642161,46.355080533536,46.41894572636459,46.36198377557798,46.21423566390641,46.4617659556619,46.40439969043423,46.14328368971078,46.2978458240606,46.29718708288624,46.26462973461529,46.07185465108607,46.10709380961848,45.89645410765824,45.76848131581383,45.7901505978108,45.81723552218485,45.7571299352978,45.99604770748744,45.92102321723055,45.85928065701999,46.16960795747501,46.24248346636151,46.21962755969027,46.18847392543737,46.1567312828091,46.04119110418402,46.06580522806848,45.88240415888774,45.89677367930479,45.91407065163952,45.89106341663008,46.3907128846604,46.02190823807744,46.11646457392005,46.2625128177377,46.28473863606153,45.82911287870145,46.05392253937582,46.48684709822216,46.55041102912372,46.40507365214159,46.40557733341657,46.27734538915659,46.42000922439679,46.19827048067779,45.95223460301838,45.51836846308994,45.45464604201593,45.59957298730513,46.18935582161797,45.78151327768866],[11.24021925829678,11.30492774951227,11.49444689184314,11.61981213567064,11.79562781955607,11.91511324351642,11.25373684976809,10.67567468662156,10.9161479275145,11.19746506390929,11.03126641319532,11.09340515626152,11.86245191063438,11.61350627239343,11.0374183204832,11.59826015100979,11.78767245842424,11.37616326655795,11.13566254266571,11.30224864894579,11.04381157669139,11.1349893947758,11.11101197463412,10.95311763568258,10.99989189236901,10.52382121481765,10.62677617948781,10.57543030243833,10.72727323477272,10.83837601894569,10.88943683987206,10.78451891369767,10.75779698315485,10.73108300085617,10.98093101642332,10.88261559389168,10.71909710398985,11.17142656253257,10.95223877857737,11.11887741301661,11.03988939175422,11.65969020850257,10.59683779829867,11.4518321121155,10.53567100302245,10.51406361437554,10.83181104187128,11.87326094173421,11.58587652330664,11.3182491468992,11.36775098523348,10.5622244361311,10.4730140861868,10.44203868109529,10.76566841649004,10.77234829865593,10.84875134110692,11.13445901745498,10.94726370891874],6,null,"trentino_stations",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":0.9,"fill":true,"fillColor":"#0000FF","fillOpacity":0.6},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.24022&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.05256&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0001&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.30493&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.01057&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0010&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.49445&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.11556&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0014&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.61981&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.07025&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0018&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.79563&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.26142&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0021&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.91511&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.19562&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0024&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.25374&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.94028&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0032&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.67567&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.36399&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0064&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.91615&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.35508&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0074&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.19747&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.41895&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0082&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.03127&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.36198&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0083&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>12&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.09341&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.21424&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0090&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>13&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.86245&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.46177&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0092&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>14&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.61351&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.40440&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0094&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>15&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.03742&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.14328&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0099&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>16&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.59826&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.29785&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0102&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>17&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.78767&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.29719&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0103&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>18&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.37616&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.26463&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0110&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>19&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.13566&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.07185&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0129&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>20&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.30225&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.10709&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0139&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>21&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.04381&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.89645&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0147&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>22&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.13499&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.76848&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0149&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>23&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.11101&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.79015&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0150&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>24&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.95312&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.81724&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0152&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>25&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.99989&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.75713&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0154&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>26&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.52382&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.99605&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0157&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>27&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.62678&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.92102&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0160&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>28&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.57543&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.85928&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0163&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>29&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.72727&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.16961&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0166&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>30&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.83838&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.24248&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0168&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>31&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.88944&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.21963&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0169&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>32&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.78452&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.18847&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0172&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>33&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.75780&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.15673&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0175&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>34&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.73108&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.04119&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0179&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>35&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.98093&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.06581&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0189&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>36&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.88262&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.88240&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0193&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>37&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.71910&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.89677&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0204&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>38&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.17143&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.91407&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0210&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>39&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.95224&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.89106&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0211&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>40&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.11888&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.39071&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0236&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>41&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.03989&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.02191&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0327&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>42&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.65969&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.11646&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0355&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>43&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.59684&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.26251&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0360&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>44&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.45183&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.28474&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0367&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>45&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.53567&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.82911&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0370&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>46&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.51406&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.05392&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>T0373&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>47&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.83181&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.48685&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>B2440&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>48&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.87326&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.55041&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>B6130&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>49&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.58588&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.40507&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>B7810&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>50&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.31825&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.40558&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>B8570&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>51&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.36775&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.27735&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>B9100&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>52&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.56222&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.42001&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>LFORN&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>53&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.47301&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.19827&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>LAVIO&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>54&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.44204&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.95223&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>LVACC&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>55&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.76567&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.51837&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>VBARD&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>56&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.77235&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.45465&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>VCAST&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>57&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.84875&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.59957&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>VDOLC&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>58&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>11.13446&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>46.18936&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>SMICH&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>59&emsp;<\/td><\/tr><tr><td>1<\/td><th>x&emsp;<\/th><td>10.94726&emsp;<\/td><\/tr><tr><td>2<\/td><th>y&emsp;<\/th><td>45.78151&emsp;<\/td><\/tr><tr><td>3<\/td><th>name&emsp;<\/th><td>POLSA&emsp;<\/td><\/tr><tr><td>4<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[10.44203868109529,45.45464604201593,11.91511324351642,46.55041102912372,true,"trentino_stations","Zoom to trentino_stations","<strong> trentino_stations <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],"trentino_stations",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#0000FF"],"labels":["trentino_stations"],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"trentino_stations"}]}],"limits":{"lat":[45.45464604201593,46.55041102912372],"lng":[10.44203868109529,11.91511324351642]},"fitBounds":[45.45464604201593,10.44203868109529,46.55041102912372,11.91511324351642,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script><p>Weather data are contained in three data frames (one for each
variable) where the first 3 columns refer to year, month and day whereas
the other columns refer to each gauging station.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">TEMPERATURE_MAX</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">TEMPERATURE_MIN</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">PRECIPITATION</span><span class="op">)</span></span>
<span>  </span></code></pre></div>
<p>A reference period between 1961 and 1990 is taken:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year_min</span> <span class="op">&lt;-</span> <span class="fl">1961</span></span>
<span><span class="va">year_max</span> <span class="op">&lt;-</span> <span class="fl">1990</span></span>
<span></span>
<span><span class="va">origin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year_min</span>,<span class="fl">1</span>,<span class="fl">1</span>,sep<span class="op">=</span><span class="st">"-"</span><span class="op">)</span></span>
<span><span class="va">period</span> <span class="op">&lt;-</span> <span class="va">PRECIPITATION</span><span class="op">$</span><span class="va">year</span><span class="op">&gt;=</span><span class="va">year_min</span> <span class="op">&amp;</span> <span class="va">PRECIPITATION</span><span class="op">$</span><span class="va">year</span><span class="op">&lt;=</span><span class="va">year_max</span></span>
<span><span class="va">period_temp</span> <span class="op">&lt;-</span> <span class="va">TEMPERATURE_MAX</span><span class="op">$</span><span class="va">year</span><span class="op">&gt;=</span><span class="va">year_min</span> <span class="op">&amp;</span> <span class="va">TEMPERATURE_MAX</span><span class="op">$</span><span class="va">year</span><span class="op">&lt;=</span><span class="va">year_max</span></span></code></pre></div>
<p>The time series in the reference period are saved as new variables:
<em>prec_mes</em>,<em>Tx_mes</em> and <em>Tn_mes</em>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prec_mes</span> <span class="op">&lt;-</span> <span class="va">PRECIPITATION</span><span class="op">[</span><span class="va">period</span>,<span class="op">]</span></span>
<span><span class="va">Tx_mes</span> <span class="op">&lt;-</span> <span class="va">TEMPERATURE_MAX</span><span class="op">[</span><span class="va">period_temp</span>,<span class="op">]</span></span>
<span><span class="va">Tn_mes</span> <span class="op">&lt;-</span> <span class="va">TEMPERATURE_MIN</span><span class="op">[</span><span class="va">period_temp</span>,<span class="op">]</span></span></code></pre></div>
<p>The analysis has been focused only on the stations whose time series
is completed within the reference period.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">accepted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">accepted</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">it</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">acc</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>    <span class="va">acc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Tx_mes</span><span class="op">[</span>,<span class="va">it</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Tx_mes</span><span class="op">[</span>,<span class="va">it</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">acc</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Tn_mes</span><span class="op">[</span>,<span class="va">it</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Tn_mes</span><span class="op">[</span>,<span class="va">it</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">acc</span></span>
<span>    <span class="va">accepted</span><span class="op">[</span><span class="va">it</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">it</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">it</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">acc</span></span>
<span>    </span>
<span><span class="op">}</span></span></code></pre></div>
<p>The station involved in the computation are then the following:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">accepted</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "month" "day"   "year"  "T0001" "T0010" "T0014" "T0018" "T0021" "T0024"</span></span>
<span><span class="co">#&gt; [10] "T0032" "T0064" "T0074" "T0082" "T0083" "T0090" "T0092" "T0094" "T0099"</span></span>
<span><span class="co">#&gt; [19] "T0102" "T0103" "T0110" "T0129" "T0139" "T0147" "T0149" "T0150" "T0152"</span></span>
<span><span class="co">#&gt; [28] "T0154" "T0157" "T0160" "T0163" "T0166" "T0168" "T0169" "T0172" "T0175"</span></span>
<span><span class="co">#&gt; [37] "T0179" "T0189" "T0193" "T0204" "T0210" "T0211" "T0236" "T0327" "T0355"</span></span>
<span><span class="co">#&gt; [46] "T0360" "T0367" "T0370" "T0373" "B2440" "B6130" "B7810" "B8570" "B9100"</span></span>
<span><span class="co">#&gt; [55] "LFORN" "LAVIO" "LVACC" "VBARD" "VCAST" "VDOLC" "SMICH" "POLSA"</span></span></code></pre></div>
<p>Three data frames for observed values of daily precipitation:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">prec_mes</span> <span class="op">&lt;-</span> <span class="va">prec_mes</span><span class="op">[</span>,<span class="va">accepted</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">)</span></span>
<span><span class="co">#&gt;      month day year T0001 T0014 T0064  T0083 T0090  T0129 T0139 T0211 T0367</span></span>
<span><span class="co">#&gt; 1097     1   1 1961   0.0  0.00   0.0  0.000  0.00  0.000  0.00   1.3   0.0</span></span>
<span><span class="co">#&gt; 1098     1   2 1961  10.8  7.38  14.0  6.765  0.00 12.900  9.43  15.5  10.4</span></span>
<span><span class="co">#&gt; 1099     1   3 1961   0.0  0.00   0.0  0.000  0.00  0.172  0.00   0.0   0.0</span></span>
<span><span class="co">#&gt; 1100     1   4 1961  22.2 25.56  32.5 61.500 12.96 33.368 17.25  38.3   8.0</span></span>
<span><span class="co">#&gt; 1101     1   5 1961   0.0  0.00   0.0  0.000  0.00  0.000  0.00   0.0   0.0</span></span>
<span><span class="co">#&gt; 1102     1   6 1961   0.0  0.00   0.0  0.000  0.00  0.000  0.00   0.0   1.0</span></span></code></pre></div>
<p>;maximum temparature:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Tx_mes</span> <span class="op">&lt;-</span> <span class="va">Tx_mes</span><span class="op">[</span>,<span class="va">accepted</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Tx_mes</span><span class="op">)</span></span>
<span><span class="co">#&gt;      month day year T0001 T0014 T0064 T0083 T0090 T0129 T0139 T0211 T0367</span></span>
<span><span class="co">#&gt; 1097     1   1 1961 -0.08 -0.83    -2  1.36  1.87  1.19    -1 -0.11 -0.16</span></span>
<span><span class="co">#&gt; 1098     1   2 1961  0.92 -1.13    -3  0.36  1.44  2.79    -2  2.90  4.84</span></span>
<span><span class="co">#&gt; 1099     1   3 1961  0.92 -1.83     2 -0.64  1.87  0.79    -4  1.90 -2.16</span></span>
<span><span class="co">#&gt; 1100     1   4 1961  5.92  0.57     1  1.36  1.44  2.79     0  2.90  7.84</span></span>
<span><span class="co">#&gt; 1101     1   5 1961  3.92  0.77     5  6.36  3.87  4.79     5  2.90  2.84</span></span>
<span><span class="co">#&gt; 1102     1   6 1961 -0.08 -1.43     3  4.36  2.87  0.79     3 -2.10 -2.16</span></span></code></pre></div>
<p>and minimum temparature:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Tn_mes</span> <span class="op">&lt;-</span> <span class="va">Tn_mes</span><span class="op">[</span>,<span class="va">accepted</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Tn_mes</span><span class="op">)</span></span>
<span><span class="co">#&gt;      month day year T0001 T0014  T0064 T0083 T0090 T0129 T0139 T0211  T0367</span></span>
<span><span class="co">#&gt; 1097     1   1 1961    -6 -5.39  -6.44 -6.23 -2.56  0.17    -6 -3.55  -6.24</span></span>
<span><span class="co">#&gt; 1098     1   2 1961    -2 -4.79  -7.44 -3.23  0.87 -0.83    -5 -2.55  -9.24</span></span>
<span><span class="co">#&gt; 1099     1   3 1961    -9 -5.39  -6.44 -6.23 -1.56 -2.83    -5 -3.55  -5.24</span></span>
<span><span class="co">#&gt; 1100     1   4 1961     0 -4.89  -4.44 -4.23  0.87  0.17    -4  0.45  -9.24</span></span>
<span><span class="co">#&gt; 1101     1   5 1961    -5 -6.39  -8.44 -8.23 -5.56 -1.83    -6 -3.55 -12.24</span></span>
<span><span class="co">#&gt; 1102     1   6 1961    -8 -7.59 -11.44 -9.23 -7.56 -4.83    -8 -5.55  -8.24</span></span></code></pre></div>
<p>are created. Rainy or wet day is defined as a day where precipition
occurs and its precipitation value is equal or greater than 1 mm. If
precipation is lower or zero, the day is defined as dry. Therefore, a
data frame of logical values containing precipitation occurrence is
created:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">valmin</span> <span class="op">&lt;-</span> <span class="fl">1.0</span></span>
<span><span class="va">prec_occurence_mes</span> <span class="op">&lt;-</span> <span class="va">prec_mes</span></span>
<span><span class="va">station</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"day"</span>,<span class="st">"month"</span>,<span class="st">"year"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">prec_occurence_mes</span><span class="op">[</span>,<span class="va">station</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">prec_mes</span><span class="op">[</span>,<span class="va">station</span><span class="op">]</span><span class="op">&gt;=</span><span class="va">valmin</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">prec_occurence_mes</span><span class="op">)</span></span>
<span><span class="co">#&gt;      month day year T0001 T0014 T0064 T0083 T0090 T0129 T0139 T0211 T0367</span></span>
<span><span class="co">#&gt; 1097     1   1 1961 FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE</span></span>
<span><span class="co">#&gt; 1098     1   2 1961  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE</span></span>
<span><span class="co">#&gt; 1099     1   3 1961 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; 1100     1   4 1961  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span></span>
<span><span class="co">#&gt; 1101     1   5 1961 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE</span></span>
<span><span class="co">#&gt; 1102     1   6 1961 FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generation-of-precipitation-in-one-station">Generation of Precipitation in One Station<a class="anchor" aria-label="anchor" href="#generation-of-precipitation-in-one-station"></a>
</h2>
<div class="section level3">
<h3 id="occurrence">Occurrence<a class="anchor" aria-label="anchor" href="#occurrence"></a>
</h3>
<p>A precipitation occurrence generator model is created in order to
reproduce a time series consistent with observed time series in:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">it1</span> <span class="op">&lt;-</span> <span class="st">"T0083"</span> <span class="co">#station[2]</span></span>
<span><span class="va">it1</span></span>
<span><span class="co">#&gt; [1] "T0083"</span></span></code></pre></div>
<p>Let assume that precipitation occurrence also depend on the diurnal
temperature variation which is taken into account as an exogenous
variable. Therefore, a model based on a logistic regression with a
generalized linear model is created and saved as <em>model1</em>
variable;</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exogen</span> <span class="op">&lt;-</span> <span class="va">Tx_mes</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span><span class="op">-</span><span class="va">Tn_mes</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span></span>
<span><span class="va">months</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">$</span><span class="va">month</span><span class="op">)</span></span>
<span><span class="va">model1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrecipitationOccurrenceModel.html">PrecipitationOccurrenceModel</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span>,exogen<span class="op">=</span><span class="va">exogen</span>,monthly.factor<span class="op">=</span><span class="va">months</span><span class="op">)</span></span></code></pre></div>
<p>The model is an S3 opject:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PrecipitationOccurrenceModel"</span></span></code></pre></div>
<p>constituting of a list of 5 elements:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">unclass</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "list"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">model1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "predictor" "glm"       "p"         "valmin"    "id.name"</span></span></code></pre></div>
<p>The first element is a data frame containing the predictor values:
the exogenous variable, the month of the year and the precipiation
occurrence at the previous days:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">model1</span><span class="op">$</span><span class="va">predictor</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ exogen: num  7.59 3.59 5.59 5.59 14.59 ...</span></span>
<span><span class="co">#&gt;  $ month : Factor w/ 12 levels "1","2","3","4",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ x_l01 : logi  NA FALSE TRUE FALSE TRUE FALSE ...</span></span></code></pre></div>
<p>Then, a genaralized linear model :</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model1</span><span class="op">$</span><span class="va">glm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; glm(formula = df, family = "binomial")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; (Intercept)  1.440154   0.122650  11.742  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; exogen      -0.330272   0.008389 -39.368  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; month2       0.164982   0.141512   1.166   0.2437    </span></span>
<span><span class="co">#&gt; month3       0.904704   0.136761   6.615 3.71e-11 ***</span></span>
<span><span class="co">#&gt; month4       1.222853   0.134677   9.080  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; month5       1.736783   0.130607  13.298  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; month6       2.034278   0.130296  15.613  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; month7       1.883444   0.130523  14.430  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; month8       1.819358   0.130535  13.938  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; month9       1.250177   0.136727   9.144  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; month10      0.810081   0.138679   5.841 5.18e-09 ***</span></span>
<span><span class="co">#&gt; month11      0.272739   0.134311   2.031   0.0423 *  </span></span>
<span><span class="co">#&gt; month12     -0.291167   0.139652  -2.085   0.0371 *  </span></span>
<span><span class="co">#&gt; x_l01TRUE    0.791204   0.053903  14.678  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Dispersion parameter for binomial family taken to be 1)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Null deviance: 12790.1  on 10955  degrees of freedom</span></span>
<span><span class="co">#&gt; Residual deviance:  9572.5  on 10942  degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: 9600.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of Fisher Scoring iterations: 5</span></span></code></pre></div>
<p>The third element is the order of the autoregression, i.e. the number
of previous days whose data are used as predictors in the genaralized
linear model:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">p</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>The minimum daily precipitation value above which the day ids
considered as wet, e.g. 1 mm:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model1</span><span class="op">$</span><span class="va">valmin</span></span>
<span><span class="co">#&gt; [1] 0.5</span></span></code></pre></div>
<p>Then, a field name is considered:</p>
<pre><code><span><span class="va">model</span><span class="op">$</span><span class="va">id.name</span></span></code></pre>
<p>Once built the model, the time series of daily probabilities of
precipitation occurrence can be predicted:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">model1</span><span class="op">$</span><span class="va">glm</span>,type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span></code></pre></div>
<p>where <em>probs</em> is the predicted probabability of precipitation
occurrence releted to the time series of the observed values: each
element of <em>probs</em> corresponds to the day of the corresponding
row of the input dataset <em>prec_mes[,it]</em>. In case that the model
is applied to a daily time series of precipitation occurrence and
exogenous variale, i.e. predictors, they must be included as a new data
frame equal to <em>newdata</em> argument:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">row_test</span> <span class="op">&lt;-</span> <span class="fl">2000</span><span class="op">:</span><span class="fl">2007</span></span>
<span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="va">model1</span><span class="op">$</span><span class="va">predictor</span><span class="op">[</span><span class="va">row_test</span>,<span class="op">]</span></span></code></pre></div>
<p>For instance, subsetting the observiations, a new dataset is
created:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;      exogen month x_l01</span></span>
<span><span class="co">#&gt; 2000  12.76     6 FALSE</span></span>
<span><span class="co">#&gt; 2001  13.76     6 FALSE</span></span>
<span><span class="co">#&gt; 2002  15.76     6 FALSE</span></span>
<span><span class="co">#&gt; 2003  16.76     6  TRUE</span></span>
<span><span class="co">#&gt; 2004  12.76     6 FALSE</span></span>
<span><span class="co">#&gt; 2005  14.76     6 FALSE</span></span>
<span><span class="va">newdata</span><span class="op">$</span><span class="va">probs2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict.html">predict</a></span><span class="op">(</span><span class="va">model1</span>,newdata<span class="op">=</span><span class="va">newdata</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">)</span></span>
<span><span class="co">#&gt;      exogen month x_l01    probs2</span></span>
<span><span class="co">#&gt; 2000  12.76     6 FALSE 0.3230402</span></span>
<span><span class="co">#&gt; 2001  13.76     6 FALSE 0.2553828</span></span>
<span><span class="co">#&gt; 2002  15.76     6 FALSE 0.1505044</span></span>
<span><span class="co">#&gt; 2003  16.76     6  TRUE 0.2193055</span></span>
<span><span class="co">#&gt; 2004  12.76     6 FALSE 0.3230402</span></span>
<span><span class="co">#&gt; 2005  14.76     6 FALSE 0.1977561</span></span></code></pre></div>
<p>Once obtained the model, a random stochastic time series of daily
precipitation occurrence is generated through <em>generate</em> method.
First of all, the following predictors are needed:</p>
<ul>
<li>a time series of exogenous variables is needeed.</li>
<li>a time series of month factor indicating the corresponding month of
the year for each day of the new stochastically generated time
series;</li>
</ul>
<p>These two time series must be of the same length which corresponds to
the length of the time series that is about to generate. For instance,
if the time series is a replication of the observed one, it is:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exogen</span> <span class="op">&lt;-</span> <span class="va">exogen</span></span>
<span><span class="va">months</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">$</span><span class="va">month</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1235</span><span class="op">)</span></span>
<span><span class="va">prec_gen1_occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span><span class="va">model1</span>,exogen<span class="op">=</span><span class="va">exogen</span>,monthly.factor<span class="op">=</span><span class="va">months</span>,n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">months</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="amount">Amount<a class="anchor" aria-label="anchor" href="#amount"></a>
</h3>
<p>Once generated precipitation occurrence values, precipitation amount
values are genereted through a stochastic generator model. The
precipitation amount stochastic generator is built as follows:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model1_amount</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrecipitationAmountModel.html">PrecipitationAmountModel</a></span><span class="op">(</span><span class="va">prec_mes</span>,station<span class="op">=</span><span class="va">it1</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span></span></code></pre></div>
<p>where <em>model_amount</em> is an S3 object:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model1_amount</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PrecipitationAmountModel"</span></span></code></pre></div>
<p>containing the following items:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">model1_amount</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "T0083"   "station" "sample"  "x"       "origin"  "valmin"</span></span></code></pre></div>
<p>The first item is a generalized linear model, in which Gaussianized
value of precipitation depends on month:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model1_amount</span><span class="op">[[</span><span class="va">it1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -2.74134 -0.68036 -0.00999  0.66302  3.07671 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) -0.01865    0.08008  -0.233    0.816</span></span>
<span><span class="co">#&gt; month2       0.08147    0.11382   0.716    0.474</span></span>
<span><span class="co">#&gt; month3       0.03716    0.10579   0.351    0.725</span></span>
<span><span class="co">#&gt; month4       0.02625    0.10285   0.255    0.799</span></span>
<span><span class="co">#&gt; month5       0.04111    0.09830   0.418    0.676</span></span>
<span><span class="co">#&gt; month6       0.04275    0.09792   0.437    0.662</span></span>
<span><span class="co">#&gt; month7       0.01087    0.09960   0.109    0.913</span></span>
<span><span class="co">#&gt; month8       0.04105    0.10012   0.410    0.682</span></span>
<span><span class="co">#&gt; month9       0.03853    0.10659   0.362    0.718</span></span>
<span><span class="co">#&gt; month10      0.04228    0.10849   0.390    0.697</span></span>
<span><span class="co">#&gt; month11      0.04162    0.10483   0.397    0.691</span></span>
<span><span class="co">#&gt; month12      0.05511    0.11699   0.471    0.638</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.9873 on 2608 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0003119,  Adjusted R-squared:  -0.003905 </span></span>
<span><span class="co">#&gt; F-statistic: 0.07398 on 11 and 2608 DF,  p-value: 1</span></span></code></pre></div>
<p>Other items are the following variables: names of the considered
station (e.g. only <em>“T0083”</em>}), the origin date of the time
series used to build the model and the minimum value of precipipition to
consider as precipitation occurrence, in this case 1 mm.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model1_amount</span><span class="op">$</span><span class="va">station</span></span>
<span><span class="co">#&gt; [1] "T0083"</span></span>
<span><span class="va">model1_amount</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt; [1] "monthly"</span></span>
<span><span class="va">model1_amount</span><span class="op">$</span><span class="va">origin</span></span>
<span><span class="co">#&gt; [1] "1961-1-1"</span></span>
<span><span class="va">model1_amount</span><span class="op">$</span><span class="va">valmin</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>Finally, the <em>x</em> item is the data frame containing observed
time series of precipitation:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">model1_amount</span><span class="op">$</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;  $ T0083: num  0 6.76 0 61.5 0 ...</span></span></code></pre></div>
<p>Finally, a time series, here called <em>prec_gen1</em> , is generate
by applying <em>generate</em> method to the model of precipitation
account:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">prec_gen1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span><span class="va">model1_amount</span>,newdata<span class="op">=</span><span class="va">prec_gen1_occ</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prec_gen1</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;  $ T0083: num  0 14.87 31.25 2.66 0 ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparison">Comparison<a class="anchor" aria-label="anchor" href="#comparison"></a>
</h3>
<p>The stochastic coherence between observed and generated time series
is verified through the Quantile-Quantile plot:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>obs<span class="op">=</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span>,gen<span class="op">=</span><span class="va">prec_gen1</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span> <span class="op">&lt;-</span> <span class="st">"none"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"`1.DJF"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"2.MAM"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"3.JJA"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"4.SON"</span></span>
<span><span class="va">qqplot_</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">df</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,plot.it<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span>
<span>  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">qqdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">df</span>,f<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">qqplot_</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qqdf</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qqdf</span><span class="op">)</span><span class="op">==</span><span class="st">"L1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"season"</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">qqdf</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,y<span class="op">=</span><span class="va">gen</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"observed"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"generated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-32-1.png" width="1152"></p>
<p>A comparison of the dry/wet spells, considered as periods of
consecutive dry/rainy days, between observed and generated time series
are plotted below respectively. The following lines of codes makes use
of <em>dw.spell</em> function that calculates the length expressed in
days for the dry or wet spells:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dw.spell.html">dw.spell</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">obs</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"obs"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dw.spell.html">dw.spell</a></span><span class="op">(</span><span class="va">prec_gen1</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">gen</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"gen"</span></span>
<span><span class="va">dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what<span class="op">=</span><span class="va">rbind</span>,args<span class="op">=</span><span class="va">dw</span><span class="op">)</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span> <span class="op">&lt;-</span> <span class="st">"none"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"`1.DJF"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"2.MAM"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"3.JJA"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"4.SON"</span>  </span>
<span></span>
<span><span class="va">qqdw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">dw</span>,f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">dw</span><span class="op">$</span><span class="va">spell_state</span>,<span class="va">dw</span><span class="op">$</span><span class="va">season</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">spell_length</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">variable</span><span class="op">==</span><span class="st">"obs"</span><span class="op">]</span>,gen<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">spell_length</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">variable</span><span class="op">==</span><span class="st">"gen"</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">qqplot_</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obs"</span>,<span class="st">"gen"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">qqdw_add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="va">qqdw</span><span class="op">$</span><span class="va">L1</span>,pattern<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what<span class="op">=</span><span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qqdw_add</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>,<span class="st">"season"</span><span class="op">)</span></span>
<span><span class="va">qqdw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">qqdw</span>,<span class="va">qqdw_add</span><span class="op">)</span></span></code></pre></div>
<p>Therefore, the quantile-quantile plots for the dry spells are:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qqdry</span> <span class="op">&lt;-</span> <span class="va">qqdw</span><span class="op">[</span><span class="va">qqdw</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="st">"dry"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">## ggplot plot</span></span>
<span><span class="va">ggdry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">qqdry</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,y<span class="op">=</span><span class="va">gen</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"observed"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"generated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">ggdry</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-34-1.png" width="1152">
Analogously for the wet spells it is:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qqwet</span> <span class="op">&lt;-</span> <span class="va">qqdw</span><span class="op">[</span><span class="va">qqdw</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="st">"wet"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">## ggplot plot</span></span>
<span><span class="va">ggwet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">qqwet</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,y<span class="op">=</span><span class="va">gen</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"observed"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"generated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">ggwet</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-35-1.png" width="1152"></p>
<p>It is a comparison of sample probability distributtions of daily
precipitation, dry and wet spells between the one obtained by the
observed time series and the generated time series.</p>
</div>
</div>
<div class="section level2">
<h2 id="generation-of-precipitation-in-several-stations">Generation of Precipitation in Several Stations<a class="anchor" aria-label="anchor" href="#generation-of-precipitation-in-several-stations"></a>
</h2>
<div class="section level3">
<h3 id="occurrence-1">Occurrence<a class="anchor" aria-label="anchor" href="#occurrence-1"></a>
</h3>
<p>Analogously as the one-site case, a precipitation occurrence
generator is created from precipitation time series taken in several
correlated sites belonging to a limited geographical area. For instance,
a subset of Trentino dataset stations is taken into account:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">they</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T0083"</span>,<span class="st">"T0090"</span><span class="op">)</span> <span class="co">##station</span></span>
<span><span class="va">exogen</span> <span class="op">&lt;-</span> <span class="va">Tx_mes</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span><span class="op">-</span><span class="va">Tn_mes</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span></span>
<span><span class="va">months</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">$</span><span class="va">month</span><span class="op">)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrecipitationOccurrenceMultiSiteModel.html">PrecipitationOccurrenceMultiSiteModel</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span>,exogen<span class="op">=</span><span class="va">exogen</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span></span></code></pre></div>
<p>where <em>model</em> cotains the following elements:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "T0083"   "T0090"   "ccgamma" "K"       "type"    "station" "p"</span></span></code></pre></div>
<p>in which the fist (all but the last 6) elements are single-site
precipitation occurrene models, one for each gauge precipitation
station:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PrecipitationOccurrenceModel"</span></span></code></pre></div>
<p>and the remaining ones are:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">ccgamma</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "CCGammaObjectListPerEachMonth"</span></span></code></pre></div>
<p>in which <em>ccgamma</em> is a matrix of corresponding Gaussian
correlation of precipitation occurrences calculated with the algorithm
introduced by <span class="citation">Wilks (1998)</span>; this method
makes use of a bijective relationships between correlation of binomial
processes and Gaussian processes and is used alternatively to a complete
logistic regression among stations that would have been computationally
heavier;</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">K</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "integer"</span></span></code></pre></div>
<p>in which <em>K</em> corresponds to the dimensionality (i.e. the
number of the gauging stations);</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">type</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span></code></pre></div>
<p>in which <em>type</em> is the type of the model: in this case, it is
based on Wilks’ approach to handle the plurality of the gauging
stations;</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">station</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "character"</span></span></code></pre></div>
<p>in which <em>station</em> is a vector of the names of the gauging
stations;</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">p</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "numeric"</span></span></code></pre></div>
<p>in which <em>p</em> is the lag order of autoregression for the
generalized linear model. Therefore, the stochastic generation is made
by applying <em>generate</em> method to the model:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prec_gen_occ</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span><span class="va">model</span>,exogen<span class="op">=</span><span class="va">exogen</span>,monthly.factor<span class="op">=</span><span class="va">months</span>,n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">months</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Processing T0083</span></span>
<span><span class="co">#&gt; Processing T0090</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prec_gen_occ</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ T0083: logi [1:10957(1d)] FALSE TRUE TRUE TRUE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ T0090: logi [1:10957(1d)] FALSE TRUE TRUE TRUE FALSE FALSE ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="amount-1">Amount<a class="anchor" aria-label="anchor" href="#amount-1"></a>
</h3>
<p>The precipitation amount stochastic generator is then built as
follows:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model_amount</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrecipitationAmountModel.html">PrecipitationAmountModel</a></span><span class="op">(</span><span class="va">prec_mes</span>,station<span class="op">=</span><span class="va">they</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">model_amount</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "T0083"   "T0090"   "station" "sample"  "x"       "origin"  "valmin"</span></span></code></pre></div>
<p>where <em>model_amount</em> is an S3 object:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">model_amount</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "PrecipitationAmountModel"</span></span></code></pre></div>
<p>containing the following items:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">model_amount</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "T0083"   "T0090"   "station" "sample"  "x"       "origin"  "valmin"</span></span></code></pre></div>
<p>The first elements are generalized linear models, in which
Gaussianized values of precipitation depend on month of the year:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">its</span> <span class="kw">in</span> <span class="va">model_amount</span><span class="op">$</span><span class="va">station</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_amount</span><span class="op">[[</span><span class="va">its</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>In the following, the model contains also a vector with the name of
the gauging stations and other options like for the case with only one
gauging station:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">model_amount</span><span class="op">$</span><span class="va">station</span></span>
<span><span class="co">#&gt; [1] "T0083" "T0090"</span></span>
<span><span class="va">model_amount</span><span class="op">$</span><span class="va">sample</span></span>
<span><span class="co">#&gt; [1] "monthly"</span></span>
<span><span class="va">model_amount</span><span class="op">$</span><span class="va">origin</span></span>
<span><span class="co">#&gt; [1] "1961-1-1"</span></span>
<span><span class="va">model_amount</span><span class="op">$</span><span class="va">valmin</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>Finally, a data frame with the generated times series for each
gauging station site is obtained as follows:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">prec_gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span><span class="va">model_amount</span>,newdata<span class="op">=</span><span class="va">prec_gen_occ</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_gen</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "T0083" "T0090"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="comparison-1">Comparison<a class="anchor" aria-label="anchor" href="#comparison-1"></a>
</h3>
<p>Quantile-quantile plots for precipitation time series both station
are created as follows (if not specified, measurment units are
millimiters):</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  12 variables:</span></span>
<span><span class="co">#&gt;  $ month: int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ day  : num [1:10957(1d)] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ year : int  1961 1961 1961 1961 1961 1961 1961 1961 1961 1961 ...</span></span>
<span><span class="co">#&gt;  $ T0001: num  0 10.8 0 22.2 0 0 2.8 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ T0014: num  0 7.38 0 25.56 0 ...</span></span>
<span><span class="co">#&gt;  $ T0064: num  0 14 0 32.5 0 0 0 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ T0083: num  0 6.76 0 61.5 0 ...</span></span>
<span><span class="co">#&gt;  $ T0090: num  0 0 0 13 0 ...</span></span>
<span><span class="co">#&gt;  $ T0129: num  0 12.9 0.172 33.368 0 ...</span></span>
<span><span class="co">#&gt;  $ T0139: num  0 9.43 0 17.25 0 ...</span></span>
<span><span class="co">#&gt;  $ T0211: num  1.3 15.5 0 38.3 0 0 7.6 0 0 0 ...</span></span>
<span><span class="co">#&gt;  $ T0367: num  0 10.4 0 8 0 1 0 0 0 4.5 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prec_gen</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ T0083: num  0 3.21 8.52 21.4 0 ...</span></span>
<span><span class="co">#&gt;  $ T0090: num  0 13.49 7.68 7.68 0 ...</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs<span class="op">=</span><span class="va">prec_mes</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_gen</span><span class="op">)</span><span class="op">]</span>,gen<span class="op">=</span><span class="va">prec_gen</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span> <span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">df</span>,id<span class="op">=</span><span class="st">"date"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">==</span><span class="st">"variable"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"station"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">==</span><span class="st">"L1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"variable"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span> <span class="op">&lt;-</span> <span class="st">"none"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"1.DJF"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"2.MAM"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"3.JJA"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"4.SON"</span></span>
<span></span>
<span><span class="va">qqdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">df</span>,f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">station</span>,<span class="va">df</span><span class="op">$</span><span class="va">season</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">variable</span><span class="op">==</span><span class="st">"obs"</span><span class="op">]</span>,gen<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">value</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">variable</span><span class="op">==</span><span class="st">"gen"</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">qqplot_</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obs"</span>,<span class="st">"gen"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">qqdf_add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="va">qqdf</span><span class="op">$</span><span class="va">L1</span>,pattern<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what<span class="op">=</span><span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qqdf_add</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"station"</span>,<span class="st">"season"</span><span class="op">)</span></span>
<span><span class="va">qqdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">qqdf</span>,<span class="va">qqdf_add</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## ggplot plot</span></span>
<span><span class="va">ggdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">qqdf</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,y<span class="op">=</span><span class="va">gen</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">station</span> <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"observed"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"generated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">ggdry</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-51-1.png" width="1152"></p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">ggdf</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-51-2.png" width="1152"></p>
<p>As concerns the representation and analysis of dry/wet spells, the
respective quantile-quantile plots has been produces as follows:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dw.spell.html">dw.spell</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span></span>
<span><span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dw</span><span class="op">$</span><span class="va">obs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">dw</span><span class="op">$</span><span class="va">obs</span>,id<span class="op">=</span><span class="va">nn</span><span class="op">)</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">obs</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"obs"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dw.spell.html">dw.spell</a></span><span class="op">(</span><span class="va">prec_gen</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id<span class="op">=</span><span class="va">nn</span><span class="op">)</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">gen</span><span class="op">$</span><span class="va">variable</span> <span class="op">&lt;-</span> <span class="st">"gen"</span></span>
<span></span>
<span><span class="va">dw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what<span class="op">=</span><span class="va">rbind</span>,args<span class="op">=</span><span class="va">dw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dw</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dw</span><span class="op">)</span><span class="op">==</span><span class="st">"L1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"station"</span></span>
<span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span> <span class="op">&lt;-</span> <span class="st">"none"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"`1.DJF"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"2.MAM"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"3.JJA"</span></span>
<span><span class="va">dw</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">dw</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"4.SON"</span>  </span>
<span></span>
<span><span class="va">qqdw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">dw</span>,f<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">dw</span><span class="op">$</span><span class="va">spell_state</span>,<span class="va">dw</span><span class="op">$</span><span class="va">station</span>,<span class="va">dw</span><span class="op">$</span><span class="va">season</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>obs<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">spell_length</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">variable</span><span class="op">==</span><span class="st">"obs"</span><span class="op">]</span>,gen<span class="op">=</span><span class="va">x</span><span class="op">$</span><span class="va">spell_length</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">variable</span><span class="op">==</span><span class="st">"gen"</span><span class="op">]</span><span class="op">)</span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">qqplot_</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obs"</span>,<span class="st">"gen"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qqdw_add</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_split.html" class="external-link">str_split</a></span><span class="op">(</span><span class="va">qqdw</span><span class="op">$</span><span class="va">L1</span>,pattern<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>what<span class="op">=</span><span class="va">rbind</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qqdw_add</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>,<span class="st">"station"</span>,<span class="st">"season"</span><span class="op">)</span></span>
<span><span class="va">qqdw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">qqdw</span>,<span class="va">qqdw_add</span><span class="op">)</span></span></code></pre></div>
<p>Finally, the quantile-quantile plots for the dry spells are:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qqdry</span> <span class="op">&lt;-</span> <span class="va">qqdw</span><span class="op">[</span><span class="va">qqdw</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="st">"dry"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">## ggplot plot</span></span>
<span><span class="va">ggdry</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">qqdry</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,y<span class="op">=</span><span class="va">gen</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">station</span>  <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"observed"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"generated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">ggdry</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-53-1.png" width="1152">
and the quantile-quantile plots for the wet spells are:</p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">qqwet</span> <span class="op">&lt;-</span> <span class="va">qqdw</span><span class="op">[</span><span class="va">qqdw</span><span class="op">$</span><span class="va">state</span><span class="op">==</span><span class="st">"wet"</span>,<span class="op">]</span></span>
<span></span>
<span><span class="co">## ggplot plot</span></span>
<span><span class="va">ggwet</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">qqwet</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,y<span class="op">=</span><span class="va">gen</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">station</span>  <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"observed"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"generated"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">ggwet</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-54-1.png" width="1152"></p>
<p>The comparison of sample probability distribution between observed
and generated timeseries has been tested for each month of the year:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span>      <span class="va">months</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">$</span><span class="va">month</span><span class="op">)</span></span>
<span>      <span class="va">ks_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="va">months</span><span class="op">)</span> <span class="op">{</span></span>
<span>        </span>
<span>        <span class="va">ks_test</span><span class="op">[[</span><span class="va">m</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html" class="external-link">ks.test</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">[</span><span class="va">prec_mes</span><span class="op">$</span><span class="va">month</span><span class="op">==</span><span class="va">m</span>,<span class="va">it1</span><span class="op">]</span>,<span class="va">prec_gen</span><span class="op">[</span><span class="va">prec_mes</span><span class="op">$</span><span class="va">month</span><span class="op">==</span><span class="va">m</span>,<span class="va">it1</span><span class="op">]</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="va">ks_test</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.034409, p-value = 0.6407</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.029516, p-value = 0.8543</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.04086, p-value = 0.4193</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.037778, p-value = 0.5419</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[5]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.063441, p-value = 0.04736</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[6]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.057778, p-value = 0.09912</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[7]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.053763, p-value = 0.136</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[8]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.044086, p-value = 0.3267</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[9]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.052222, p-value = 0.1717</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[10]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.070968, p-value = 0.01849</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[11]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.042222, p-value = 0.3987</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[12]]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic two-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  prec_mes[prec_mes$month == m, it1] and prec_gen[prec_mes$month == m, it1]</span></span>
<span><span class="co">#&gt; D = 0.03871, p-value = 0.4888</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span></code></pre></div>
<p>In conclusion, the spatial statistical correlation between observed
and generated time series can be checked making use of <em>CCGamma</em>
function:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ T0083: num  0 6.76 0 61.5 0 ...</span></span>
<span><span class="co">#&gt;  $ T0090: num  0 0 0 13 0 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prec_gen</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ T0083: num  0 3.21 8.52 21.4 0 ...</span></span>
<span><span class="co">#&gt;  $ T0090: num  0 13.49 7.68 7.68 0 ...</span></span>
<span><span class="va">cc_mes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CCGamma.html">CCGamma</a></span><span class="op">(</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span>,sample <span class="op">=</span> <span class="st">"monthly"</span>,origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span></span>
<span><span class="va">cc_gen</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CCGamma.html">CCGamma</a></span><span class="op">(</span><span class="va">prec_gen</span><span class="op">[</span>,<span class="va">they</span><span class="op">]</span>,sample <span class="op">=</span> <span class="st">"monthly"</span>,origin <span class="op">=</span> <span class="va">origin</span><span class="op">)</span></span></code></pre></div>
<p>where <em>cc_mes</em> and <em>cc_gen</em> are lists containing joint
probability and correlation matrices among precipitation occurrences for
each couple of sites. In case of <em>sample=monthly</em> setting, these
matrices are replicated for each of the 12 months of the year. The
structures of <em>cc_mes</em> and <em>cc_gen</em> can be displayed as
follows:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cc_mes</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">cc_gen</span><span class="op">)</span></span></code></pre></div>
<p>Then, the estimated correlation matrix of no-precipitation occurrence
per each month of the year and for observed time series is:</p>
<pre><code><span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.7172415</span></span>
<span><span class="co">#&gt; [2,] 0.7172415 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.7185805</span></span>
<span><span class="co">#&gt; [2,] 0.7185805 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`3`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.7603387</span></span>
<span><span class="co">#&gt; [2,] 0.7603387 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`4`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.7686571</span></span>
<span><span class="co">#&gt; [2,] 0.7686571 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`5`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6891203</span></span>
<span><span class="co">#&gt; [2,] 0.6891203 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`6`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6421596</span></span>
<span><span class="co">#&gt; [2,] 0.6421596 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`7`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6617584</span></span>
<span><span class="co">#&gt; [2,] 0.6617584 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`8`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6778738</span></span>
<span><span class="co">#&gt; [2,] 0.6778738 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`9`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.7237239</span></span>
<span><span class="co">#&gt; [2,] 0.7237239 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`10`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.8075086</span></span>
<span><span class="co">#&gt; [2,] 0.8075086 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`11`</span></span>
<span><span class="co">#&gt;          [,1]     [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.000000 0.784554</span></span>
<span><span class="co">#&gt; [2,] 0.784554 1.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`12`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.7486674</span></span>
<span><span class="co">#&gt; [2,] 0.7486674 1.0000000</span></span></code></pre>
<pre><code><span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.5684831</span></span>
<span><span class="co">#&gt; [2,] 0.5684831 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6876702</span></span>
<span><span class="co">#&gt; [2,] 0.6876702 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`3`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6979002</span></span>
<span><span class="co">#&gt; [2,] 0.6979002 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`4`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6766009</span></span>
<span><span class="co">#&gt; [2,] 0.6766009 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`5`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.5829847</span></span>
<span><span class="co">#&gt; [2,] 0.5829847 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`6`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.5454573</span></span>
<span><span class="co">#&gt; [2,] 0.5454573 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`7`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.5905328</span></span>
<span><span class="co">#&gt; [2,] 0.5905328 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`8`</span></span>
<span><span class="co">#&gt;          [,1]     [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.000000 0.576023</span></span>
<span><span class="co">#&gt; [2,] 0.576023 1.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`9`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6046216</span></span>
<span><span class="co">#&gt; [2,] 0.6046216 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`10`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.7097068</span></span>
<span><span class="co">#&gt; [2,] 0.7097068 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`11`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6752921</span></span>
<span><span class="co">#&gt; [2,] 0.6752921 1.0000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`12`</span></span>
<span><span class="co">#&gt;           [,1]      [,2]</span></span>
<span><span class="co">#&gt; [1,] 1.0000000 0.6298554</span></span>
<span><span class="co">#&gt; [2,] 0.6298554 1.0000000</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="modifying-precipitation-distribution-e-g--precipitation-futture-projection">Modifying Precipitation Distribution (e.g. Precipitation Futture
Projection)<a class="anchor" aria-label="anchor" href="#modifying-precipitation-distribution-e-g--precipitation-futture-projection"></a>
</h2>
<p>Let assume that once tested and verified the stochastic generation
model, the precipitation stochastic generator may be used to generate a
time series with specific probability distribution of daily
precipitation (e.g. future climate change scenarios). The observed daily
precipitation sample distribution for the reference station is retrieved
and plotted as follows:</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>obs<span class="op">=</span><span class="va">prec_mes</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span>,gen<span class="op">=</span><span class="va">prec_gen1</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">origin</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span> <span class="op">&lt;-</span> <span class="st">"none"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"1.DJF"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"2.MAM"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"3.JJA"</span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">month</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">10</span>,<span class="fl">11</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="st">"4.SON"</span></span>
<span></span>
<span><span class="va">dfp</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">df</span><span class="op">$</span><span class="va">obs</span><span class="op">&gt;</span><span class="va">valmin</span>,<span class="op">]</span> </span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">color_month</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E6352F"</span>,<span class="st">"#34A74B"</span>,<span class="st">"#3D79F3"</span> <span class="op">)</span>,<span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">gdens</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">dfp</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,color<span class="op">=</span><span class="va">month</span>,group<span class="op">=</span><span class="va">month</span><span class="op">)</span>,trim<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">season</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gdens</span> <span class="op">&lt;-</span> <span class="va">gdens</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">color_month</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">gdens</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-61-1.png" width="672"></p>
<p>Though the method of L-moments (<span class="citation">Hosking
(2019)</span>) , the monthly samples of daily precipitation are fitted
with a LN3 (<span class="citation">Sangal and Biswas (1970)</span>)
distribution, in most of months the null hypothesis of the
Kolgormov-Smirnov test can be accepted (<em>pvalue&gt;0.1</em>):</p>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lmom</span><span class="op">)</span></span>
<span></span>
<span><span class="va">prec_val_m</span> <span class="op">&lt;-</span> <span class="va">dfp</span><span class="op">$</span><span class="va">obs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">dfp</span><span class="op">$</span><span class="va">month</span><span class="op">)</span> </span>
<span><span class="va">lmoms</span> <span class="op">&lt;-</span> <span class="va">prec_val_m</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">samlmu</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">params</span> <span class="op">&lt;-</span> <span class="va">lmoms</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">pelln3</span>,bound<span class="op">=</span><span class="va">valmin</span><span class="op">)</span> </span>
<span><span class="va">kstest</span> <span class="op">&lt;-</span><span class="va">params</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">ks.test</span>,x<span class="op">=</span><span class="va">prec_val_m</span>,y<span class="op">=</span><span class="st">"cdfln3"</span>,SIMPLIFY<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; Warning in ks.test.default(dots[[1L]][[12L]], x = dots[[2L]][[12L]], y =</span></span>
<span><span class="co">#&gt; dots[[3L]][[1L]]): ties should not be present for the one-sample</span></span>
<span><span class="co">#&gt; Kolmogorov-Smirnov test</span></span>
<span></span>
<span><span class="va">kstest</span></span>
<span><span class="co">#&gt; $`1`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[1L]]</span></span>
<span><span class="co">#&gt; D = 0.085787, p-value = 0.2132</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`2`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[2L]]</span></span>
<span><span class="co">#&gt; D = 0.10099, p-value = 0.09575</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`3`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[3L]]</span></span>
<span><span class="co">#&gt; D = 0.061355, p-value = 0.4262</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`4`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[4L]]</span></span>
<span><span class="co">#&gt; D = 0.10053, p-value = 0.01801</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`5`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[5L]]</span></span>
<span><span class="co">#&gt; D = 0.094836, p-value = 0.009066</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`6`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[6L]]</span></span>
<span><span class="co">#&gt; D = 0.11015, p-value = 0.00125</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`7`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[7L]]</span></span>
<span><span class="co">#&gt; D = 0.10352, p-value = 0.005513</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`8`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[8L]]</span></span>
<span><span class="co">#&gt; D = 0.080746, p-value = 0.06071</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`9`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[9L]]</span></span>
<span><span class="co">#&gt; D = 0.086088, p-value = 0.1095</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`10`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[10L]]</span></span>
<span><span class="co">#&gt; D = 0.097067, p-value = 0.0648</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`11`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[11L]]</span></span>
<span><span class="co">#&gt; D = 0.083505, p-value = 0.1054</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`12`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; data:  dots[[2L]][[12L]]</span></span>
<span><span class="co">#&gt; D = 0.09957, p-value = 0.1459</span></span>
<span><span class="co">#&gt; alternative hypothesis: two-sided</span></span></code></pre></div>
<p>Making the assumption that daily precipitation amount behaves as a
random variable distributed with a LN3 probability distribution, a new
scernario is created with a more flatten distrution than the estimated
one from observations by increasing the value of 2th L-moment. Through
the computation of quantiles a relationship between observed and
artificial scenerios has been assessed for each month of the year and
then plotted:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">modify_lmoments</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="fl">1.3</span>; <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">paraml</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">valmin</span><span class="op">)</span> <span class="op">{</span></span>
<span>                  <span class="va">ip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;=</span><span class="va">valmin</span><span class="op">)</span></span>
<span>                  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">ip</span><span class="op">]</span> </span>
<span>                  <span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>                  <span class="va">lmomx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmom/man/samlmu.html" class="external-link">samlmu</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>                  <span class="va">out</span><span class="op">$</span><span class="va">obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmom/man/pel-functions.html" class="external-link">pelln3</a></span><span class="op">(</span>lmom<span class="op">=</span><span class="va">lmomx</span>,bound<span class="op">=</span><span class="va">valmin</span><span class="op">)</span></span>
<span>                  <span class="va">lmomx_m</span> <span class="op">&lt;-</span> <span class="fu">modify_lmoments</span><span class="op">(</span><span class="va">lmomx</span><span class="op">)</span></span>
<span>                  <span class="va">out</span><span class="op">$</span><span class="va">mod</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lmom/man/pel-functions.html" class="external-link">pelln3</a></span><span class="op">(</span>lmom<span class="op">=</span><span class="va">lmomx_m</span>,bound<span class="op">=</span><span class="va">valmin</span><span class="op">)</span></span>
<span>                  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">modify_distribution</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">paraml</span>,<span class="va">valmin</span><span class="op">)</span><span class="op">{</span></span>
<span>                        </span>
<span>                        <span class="va">out</span> <span class="op">&lt;-</span> <span class="va">x</span></span>
<span>                        <span class="va">ip</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x</span><span class="op">&gt;=</span><span class="va">valmin</span><span class="op">)</span></span>
<span>                        <span class="va">out</span><span class="op">[</span><span class="va">ip</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">ip</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/lmom/man/cdfln3.html" class="external-link">cdfln3</a></span><span class="op">(</span>para<span class="op">=</span><span class="va">paraml</span><span class="op">$</span><span class="va">obs</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/lmom/man/cdfln3.html" class="external-link">qualn3</a></span><span class="op">(</span>para<span class="op">=</span><span class="va">paraml</span><span class="op">$</span><span class="va">mod</span><span class="op">)</span></span>
<span>                        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span></span>
<span>    </span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">para_monthly</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">obs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">paraml</span>,valmin<span class="op">=</span><span class="va">valmin</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span><span class="op">$</span><span class="va">obs_mod</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">obs</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">mo</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">month</span><span class="op">)</span><span class="op">)</span>  <span class="op">{</span></span>
<span>  <span class="va">im</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">month</span><span class="op">==</span><span class="va">mo</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">df</span><span class="op">$</span><span class="va">obs_mod</span><span class="op">[</span><span class="va">im</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">modify_distribution</span><span class="op">(</span>x<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">obs</span><span class="op">[</span><span class="va">im</span><span class="op">]</span>,paraml<span class="op">=</span><span class="va">para_monthly</span><span class="op">[[</span><span class="va">mo</span><span class="op">]</span><span class="op">]</span>,valmin<span class="op">=</span><span class="va">valmin</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">color_month</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#E6352F"</span>,<span class="st">"#34A74B"</span>,<span class="st">"#3D79F3"</span> <span class="op">)</span>,<span class="fl">4</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">df</span>,mapping<span class="op">=</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs</span>,y<span class="op">=</span><span class="va">obs_mod</span>,col<span class="op">=</span><span class="va">month</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">gg</span> <span class="op">&lt;-</span> <span class="va">gg</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">color_month</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">gg</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-63-1.png" width="672"></p>
<p>The above figure shows the relation of each month of the year between
real observations (<em>obs</em>) and modified observations
(<em>obs_mod</em>). The shape looks like a parabolic one with an
quasi-exponential increasing for high values (above 100 mm). This means
that a daily precipitation value above 100 mm may become (if variabilty
increases) 1.5 or 2 times higher. Analogously, considering the scenorio
gived by <em>obs_mod</em> time series, a precipitation amount model has
been built and then used for a new stochastic generation:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prec_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">obs_mod</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">prec_mod</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">it1</span></span>
<span><span class="va">model1_amount_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/PrecipitationAmountModel.html">PrecipitationAmountModel</a></span><span class="op">(</span><span class="va">prec_mod</span>,station<span class="op">=</span><span class="va">it1</span>,origin<span class="op">=</span><span class="va">origin</span><span class="op">)</span></span>
<span><span class="va">prec_gen1_mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate.html">generate</a></span><span class="op">(</span><span class="va">model1_amount_mod</span>,newdata<span class="op">=</span><span class="va">prec_gen1_occ</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">prec_gen1_mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    10957 obs. of  1 variable:</span></span>
<span><span class="co">#&gt;  $ T0083: num  0 3.96 2.19 1.05 0 ...</span></span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">$</span><span class="va">gen_mod</span> <span class="op">&lt;-</span> <span class="va">prec_gen1_mod</span><span class="op">[</span>,<span class="va">it1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">qqplot__</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>,<span class="va">i</span><span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">nn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span>  <span class="va">jv</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="va">i</span><span class="op">]</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">jv</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqplot</a></span><span class="op">(</span><span class="va">df</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="va">df</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>,plot.it<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">ot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">ot</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ot</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">i</span>,<span class="va">j</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">o</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ot</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">ref</span> <span class="op">&lt;-</span> <span class="va">o</span><span class="op">[[</span><span class="va">jv</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="va">jv</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ref2</span> <span class="op">&lt;-</span>  <span class="va">o</span><span class="op">[[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">ref</span><span class="op">==</span><span class="va">ref2</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">cond</span><span class="op">==</span><span class="cn">FALSE</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"qqplot__ error"</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span>args<span class="op">=</span><span class="va">o</span><span class="op">[</span><span class="va">jv</span><span class="op">]</span>,what<span class="op">=</span><span class="va">cbind</span><span class="op">)</span></span>
<span>  <span class="va">o</span> <span class="op">&lt;-</span> <span class="va">o</span><span class="op">[</span>,<span class="va">nn</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">nnn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"obs_mod"</span>,<span class="st">"gen_mod"</span>,<span class="st">"obs"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">qqdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span>,<span class="va">nnn</span><span class="op">]</span>,f<span class="op">=</span><span class="va">df</span><span class="op">$</span><span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>FUN<span class="op">=</span><span class="va">qqplot__</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span>id<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qqdf</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">qqdf</span><span class="op">)</span><span class="op">==</span><span class="st">"L1"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"season"</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">qqdf</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">obs_mod</span>,y<span class="op">=</span><span class="va">value</span>,group<span class="op">=</span><span class="va">variable</span>,color<span class="op">=</span><span class="va">variable</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_abline</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">.</span> <span class="op">~</span> <span class="va">season</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">xlab</a></span><span class="op">(</span><span class="st">"modified secenario through observated values [mm]"</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"generated / observated [mm]"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/methods/show.html" class="external-link">show</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></code></pre></div>
<p><img src="precipitation_stochastic_generation_v8_files/figure-html/unnamed-chunk-65-1.png" width="1152"></p>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>An example of the usage of the precipitation stochastic generation
contained in <strong>RGENERATEPREC</strong> package has been shown.
Visualization through quantile-quantile plots and statistical testing
(e.g. Kolgomorov-Smirnov testing), the similarity of the stastistical
properties (e.g. probability distrubtions of precipitation occurrence,
precipitation account, dry spell, wet spell per each month of the year)
between observed and generated time series hes been checked. The weather
generator can work with one or more time series generating scenarios for
several sites and mantaining their also spatial cross-correlation. This
vignette has shown an example applied to some stations of
<em>trentino</em> dataset. An example on how to use the weather
generator with data having different probabilistic distribution
(e.g. more climate variability or adaptations to future projections) has
been finally illustrated.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Adenomon2013" class="csl-entry">
Adenomon, MO, and BA Oyejola. 2013. <span>“Impact of Agriculture and
Industrialization on GDP in Nigeria: Evidence from VAR and SVAR
Models.”</span> <em>International Journal of Analysis and
Applications</em> 1 (1): 40–78.
</div>
<div id="ref-Ahn2018" class="csl-entry">
Ahn, Kuk-Hyun, and Scott Steinschneider. 2018. <span>“Time-Varying
Suspended Sediment-Discharge Rating Curves to Estimate Climate Impacts
on Fluvial Sediment Transport.”</span> <em>Hydrological Processes</em>
32 (1): 102–17. <a href="https://doi.org/10.1002/hyp.11402" class="external-link">https://doi.org/10.1002/hyp.11402</a>.
</div>
<div id="ref-Alikadic2019" class="csl-entry">
Alikadic, Azra, Ilaria Pertot, Emanuele Eccel, Claudia Dolci, Calogero
Zarbo, Amelia Caffarra, Riccardo De Filippi, and Cesare Furlanello.
2019. <span>“The Impact of Climate Change on Grapevine Phenology and the
Influence of Altitude: A Regional Study.”</span> <em>Agricultural and
Forest Meteorology</em> 271: 73–82. https://doi.org/<a href="https://doi.org/10.1016/j.agrformet.2019.02.030" class="external-link">https://doi.org/10.1016/j.agrformet.2019.02.030</a>.
</div>
<div id="ref-Bardossy2009" class="csl-entry">
Bárdossy, A., and G. Pegram. 2009. <span>“Copula Based Multisite Model
for Daily Precipitation Simulation.”</span> <em>Hydrol. Earth Syst. Sci.
Discuss.</em> 6 (3): 4485–4534. <a href="https://doi.org/10.5194/hessd-6-4485-2009" class="external-link">https://doi.org/10.5194/hessd-6-4485-2009</a>.
</div>
<div id="ref-Benmoussa2018" class="csl-entry">
Benmoussa, Haïfa, Mehdi Ben Mimoun, Mohamed Ghrab, and Eike Luedeling.
2018. <span>“Climate Change Threatens Central Tunisian Nut
Orchards.”</span> <em>International Journal of Biometeorology</em> 62
(12): 2245–55. <a href="https://doi.org/10.1007/s00484-018-1628-x" class="external-link">https://doi.org/10.1007/s00484-018-1628-x</a>.
</div>
<div id="ref-Bivand2008" class="csl-entry">
Bivand, Roger S., Edzer J. Pebesma, and Virgilio Gomez-Rubio. 2008.
<em>Applied Spatial Data Analysis with <span>R</span></em>. Springer,
NY.
</div>
<div id="ref-Brissette2007" class="csl-entry">
Brissette, F. P., M. Khalili, and R. Leconte. 2007. <span>“Efficient
Stochastic Generation of Multi-Site Synthetic Precipitation
Data.”</span> <em>Journal of Hydrology</em> 345 (3–4): 121–33. <a href="https://www.sciencedirect.com/science/article/pii/S002216940700385X" class="external-link">https://www.sciencedirect.com/science/article/pii/S002216940700385X</a>.
</div>
<div id="ref-Chen2012" class="csl-entry">
Chen, J., F. P. Brissette, and R. Leconte. 2012. <span>“WeaGETS – a
Matlab-Based Daily Scale Weather Generator for Generating Precipitation
and Temperature.”</span> <em>Procedia Environmental Sciences</em> 13
(0): 2222–35. https://doi.org/<a href="http://dx.doi.org/10.1016/j.proenv.2012.01.211" class="external-link">http://dx.doi.org/10.1016/j.proenv.2012.01.211</a>.
</div>
<div id="ref-Chen2014" class="csl-entry">
Chen, Jie, and François P. Brissette. 2014. <span>“Comparison of Five
Stochastic Weather Generators in Simulating Daily Precipitation and
Temperature for the Loess Plateau of China.”</span> <em>International
Journal of Climatology</em>, n/a–. <a href="https://doi.org/10.1002/joc.3896" class="external-link">https://doi.org/10.1002/joc.3896</a>.
</div>
<div id="ref-leaflet" class="csl-entry">
Cheng, Joe, Bhaskar Karambelkar, and Yihui Xie. 2018. <em>Leaflet:
Create Interactive Web Maps with the JavaScript ’Leaflet’ Library</em>.
<a href="https://CRAN.R-project.org/package=leaflet" class="external-link">https://CRAN.R-project.org/package=leaflet</a>.
</div>
<div id="ref-RGENERATE" class="csl-entry">
Cordano, Emanuele. 2015. <em>RGENERATE: Tools to Generate Vector Time
Series</em>. <a href="https://CRAN.R-project.org/package=RGENERATE" class="external-link">https://CRAN.R-project.org/package=RGENERATE</a>.
</div>
<div id="ref-Cordano2016" class="csl-entry">
Cordano, Emanuele, and Emanuele Eccel. 2016. <span>“Tools for Stochastic
Weather Series Generation in r Environment.”</span> <em>Italian Journal
of Agrometeorology</em> 3. <a href="https://doi.org/10.19199/2016.3.2038-5625.031" class="external-link">https://doi.org/10.19199/2016.3.2038-5625.031</a>.
</div>
<div id="ref-RMAWGEN" class="csl-entry">
———. 2019. <em>RMAWGEN: Multi-Site Auto-Regressive Weather
GENerator</em>. <a href="https://CRAN.R-project.org/package=RMAWGEN" class="external-link">https://CRAN.R-project.org/package=RMAWGEN</a>.
</div>
<div id="ref-Delerce2016" class="csl-entry">
Delerce, Sylvain, Hugo Dorado, Alexandre Grillon, Maria Camila
Rebolledo, Steven D. Prager, Victor Hugo Patiño, Gabriel Garcés Varón,
and Daniel Jiménez. 2016. <span>“Assessing Weather-Yield Relationships
in Rice at Local Scale Using Data Mining Approaches.”</span> <em>PloS
One</em> 11 (8): e0161620–20. <a href="https://doi.org/10.1371/journal.pone.0161620" class="external-link">https://doi.org/10.1371/journal.pone.0161620</a>.
</div>
<div id="ref-Fu2018" class="csl-entry">
Fu, Guobin, Francis H. S. Chiew, and Xiaogang Shi. 2018.
<span>“Generation of Multi-Site Stochastic Daily Rainfall with Four
Weather Generators: A Case Study of Gloucester Catchment in
Australia.”</span> <em>Theoretical and Applied Climatology</em> 134 (3):
1027–46. <a href="https://doi.org/10.1007/s00704-017-2306-3" class="external-link">https://doi.org/10.1007/s00704-017-2306-3</a>.
</div>
<div id="ref-lmom" class="csl-entry">
Hosking, J. R. M. 2019. <em>L-Moments</em>. <a href="https://CRAN.R-project.org/package=lmom" class="external-link">https://CRAN.R-project.org/package=lmom</a>.
</div>
<div id="ref-Kahle2013" class="csl-entry">
Kahle, David, and Hadley Wickham. 2013. <em>Ggmap: A Package for Spatial
Visualization with Google Maps and OpenStreetMap</em>. <a href="https://cran.R-project.org/package=ggmap" class="external-link">https://cran.R-project.org/package=ggmap</a>.
</div>
<div id="ref-Khalili2009" class="csl-entry">
Khalili, Malika, François Brissette, and Robert Leconte. 2009.
<span>“Stochastic Multi-Site Generation of Daily Weather Data.”</span>
<em>Stochastic Environmental Research and Risk Assessment</em> 23:
837–49. <a href="http://dx.doi.org/10.1007/s00477-008-0275-x" class="external-link">http://dx.doi.org/10.1007/s00477-008-0275-x</a>.
</div>
<div id="ref-Liu2009" class="csl-entry">
Liu, Junguo, Jimmy R. Williams, Xiuying Wang, and Hong Yang. 2009.
<span>“Using MODAWEC to Generate Daily Weather Data for the EPIC
Model.”</span> <em>Environmental Modelling &amp; Software</em> 24 (5):
655–64. https://doi.org/<a href="http://dx.doi.org/10.1016/j.envsoft.2008.10.008" class="external-link">http://dx.doi.org/10.1016/j.envsoft.2008.10.008</a>.
</div>
<div id="ref-Loecher2012" class="csl-entry">
Loecher, Markus, and Berlin School of Economics and Law. 2012.
<em>RgoogleMaps: Overlays on Google Map Tiles in r</em>. <a href="https://cran.R-project.org/package=RgoogleMaps" class="external-link">https://cran.R-project.org/package=RgoogleMaps</a>.
</div>
<div id="ref-Luguterah2013" class="csl-entry">
Luguterah, Albert, Suleman Nasiru, and Lea Anzagra. 2013. <span>“Dynamic
Relationship Between Production Growth Rates of Three Major Cereals in
Ghana.”</span> <em>Mathematical Theory and Modeling</em> 3 (8): 68–75.
</div>
<div id="ref-Mearns2001" class="csl-entry">
Mearns, L. O., W. Easterling, C. Hays, and D. Marx. 2001.
<span>“Comparison of Agricultural Impacts of Climate Change Calculated
from High and Low Resolution Climate Change Scenarios: Part i. The
Uncertainty Due to Spatial Scale.”</span> <em>Climatic Change</em> 51:
131–72. <a href="http://dx.doi.org/10.1023/A:1012297314857" class="external-link">http://dx.doi.org/10.1023/A:1012297314857</a>.
</div>
<div id="ref-Mehrotra2006" class="csl-entry">
Mehrotra, R., R. Srikanthan, and Ashish Sharma. 2006. <span>“A
Comparison of Three Stochastic Multi-Site Precipitation Occurrence
Generators.”</span> <em>Journal of Hydrology</em> 331 (1-2): 280–92. <a href="https://doi.org/10.1016/j.jhydrol.2006.05.016" class="external-link">https://doi.org/10.1016/j.jhydrol.2006.05.016</a>.
</div>
<div id="ref-Mhanna2011" class="csl-entry">
Mhanna, Muamaraldin, and Willy Bauwens. 2011. <span>“A Stochastic
Space-Time Model for the Generation of Daily Rainfall in the Gaza
Strip.”</span> <em>International Journal of Climatology</em>, n/a–. <a href="https://doi.org/10.1002/joc.2305" class="external-link">https://doi.org/10.1002/joc.2305</a>.
</div>
<div id="ref-Parlange2000" class="csl-entry">
Parlange, Marc B., and Richard W. Katz. 01 May. 2000. <span>“An Extended
Version of the Richardson Model for Simulating Daily Weather
Variables.”</span> <em>Journal of Applied Meteorology</em> 39 (5):
610–22.
</div>
<div id="ref-vars" class="csl-entry">
Pfaff, Bernhard. 2008. <span>“VAR, SVAR and SVEC Models: Implementation
Within <span>R</span> Package <span class="nocase">vars</span>.”</span>
<em>Journal of Statistical Software</em> 27 (4). <a href="https://www.jstatsoft.org/v27/i04/" class="external-link">https://www.jstatsoft.org/v27/i04/</a>.
</div>
<div id="ref-Qian2002" class="csl-entry">
Qian, Budong, João Corte-Real, and Hong Xu. 2002. <span>“Multisite
Stochastic Weather Models for Impact Studies.”</span> <em>International
Journal of Climatology</em> 22 (11): 1377–97. https://doi.org/<a href="http://dx.doi.org/10.1002/joc.808" class="external-link">http://dx.doi.org/10.1002/joc.808</a>.
</div>
<div id="ref-Racsko1991" class="csl-entry">
Racsko, P., L. Szeidl, and M. Semenov. 1991. <span>“A Serial Approach to
Local Stochastic Weather Models.”</span> <em>Ecological Modelling</em>
57 (1-2): 27–41. <a href="https://doi.org/10.1016/0304-3800(91)90053-4" class="external-link">https://doi.org/10.1016/0304-3800(91)90053-4</a>.
</div>
<div id="ref-Richardson1981" class="csl-entry">
Richardson, C. W. 1981. <span>“Stochastic Simulation of Daily
Precipitation, Temperature, and Solar Radiation.”</span> <em>Water
Resources Research</em> 17 (1): 182–90. <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/WR017i001p00182" class="external-link">https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/WR017i001p00182</a>.
</div>
<div id="ref-Sangal1970" class="csl-entry">
Sangal, B. P., and Asit K. Biswas. 1970. <span>“The 3-Parameter
Lognormal Distribution and Its Applications in Hydrology.”</span>
<em>Water Resources Research</em> 6 (2): 505–15. <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/WR006i002p00505" class="external-link">https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/WR006i002p00505</a>.
</div>
<div id="ref-Semenov2010" class="csl-entry">
Semenov, M. A., and P. Stratonovitch. 2010. <span>“Use of Multi-Model
Ensembles from Global Climate Models for Assessment of Climate Change
Impacts.”</span> <em>Climate Research</em> 41 (1): 1–14. <a href="http://www.int-res.com/abstracts/cr/v41/n1/p1-14/" class="external-link">http://www.int-res.com/abstracts/cr/v41/n1/p1-14/</a>.
</div>
<div id="ref-Semenov1997" class="csl-entry">
Semenov, Mikhail A., and Elaine M. Barrow. 1997. <span>“Use of a
Stochastic Weather Generator in the Development of Climate Change
Scenarios.”</span> <em>Climatic Change</em> 35 (4): 397–414. <a href="https://doi.org/10.1023/A:1005342632279" class="external-link">https://doi.org/10.1023/A:1005342632279</a>.
</div>
<div id="ref-Serinaldi2009" class="csl-entry">
Serinaldi, Francesco. 2009. <span>“A Multisite Daily Rainfall Generator
Driven by Bivariate Copula-Based Mixed Distributions.”</span>
<em>Journal of Geophysical Research: Atmospheres</em> 114 (D10). <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2008JD011258" class="external-link">https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2008JD011258</a>.
</div>
<div id="ref-Shahin2014" class="csl-entry">
Shahin, Md. Abu, Md. Ayub Ali, and A. B. M. Shawkat Ali. 2014.
<span>“Vector Autoregression (VAR) Modeling and Forecasting of
Temperature, Humidity, and Cloud Coverage.”</span> In <em>Computational
Intelligence Techniques in Earth and Environmental Sciences</em>, edited
by Tanvir Islam, Prashant K. Srivastava, Manika Gupta, Xuan Zhu, and
Saumitra Mukherjee, 29–51. Dordrecht: Springer Netherlands. <a href="https://doi.org/10.1007/978-94-017-8642-3_2" class="external-link">https://doi.org/10.1007/978-94-017-8642-3_2</a>.
</div>
<div id="ref-Thompson2007" class="csl-entry">
Thompson, Craig S., Peter J. Thomson, and Xiaogu Zheng. 2007.
<span>“Fitting a Multisite Daily Rainfall Model to New Zealand
Data.”</span> <em>Journal of Hydrology</em> 340 (1-2): 25–39. <a href="https://doi.org/10.1016/j.jhydrol.2007.03.020" class="external-link">https://doi.org/10.1016/j.jhydrol.2007.03.020</a>.
</div>
<div id="ref-Verdin2018" class="csl-entry">
Verdin, Andrew, Balaji Rajagopalan, William Kleiber, Guillermo Podestá,
and Federico Bert. 2018. <span>“A Conditional Stochastic Weather
Generator for Seasonal to Multi-Decadal Simulations.”</span> <em>Journal
of Hydrology</em> 556: 835–46. https://doi.org/<a href="https://doi.org/10.1016/j.jhydrol.2015.12.036" class="external-link">https://doi.org/10.1016/j.jhydrol.2015.12.036</a>.
</div>
<div id="ref-Wilks1998" class="csl-entry">
Wilks, D. S. 1998. <span>“Multisite Generalization of a Daily Stochastic
Precipitation Generation Model.”</span> <em>Journal of Hydrology</em>
210 (1-4): 178–91. <a href="https://doi.org/10.1016/S0022-1694(98)00186-3" class="external-link">https://doi.org/10.1016/S0022-1694(98)00186-3</a>.
</div>
<div id="ref-Wilks1999" class="csl-entry">
Wilks, D. S., and R. L. Wilby. 1999. <span>“The Weather Generation Game:
A Review of Stochastic Weather Models.”</span> <em>Progress in Physical
Geography</em> 23 (3): 329–57. <a href="https://doi.org/10.1177/030913339902300302" class="external-link">https://doi.org/10.1177/030913339902300302</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Emanuele Cordano.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
